# https://www.stigviewer.com/stig/toss_4/2023-xx-xx/finding/V-253059

# Verify TOSS implements DoD-approved encryption to protect the
# confidentiality of remote access sessions. Check to see if FIPS mode is enabled
# with the following command: $ fips-mode-setup --check FIPS mode is enabled If
# FIPS mode is "enabled", check to see if the kernel boot parameter is configured
# for FIPS mode with the following command: $ sudo grub2-editenv list | grep fips
# kernelopts=root=/dev/mapper/rhel-root ro crashkernel=auto
# resume=/dev/mapper/rhel-swap rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap rhgb quiet
# fips=1 boot=UUID=8d171156-cd61-421c-ba41-1c021ac29e82 If the kernel boot
# parameter is configured to use FIPS mode, check to see if the system is in FIPS
# mode with the following command: $ sudo cat /proc/sys/crypto/fips_enabled 1 If
# FIPS mode is not "on", the kernel boot parameter is not configured for FIPS
# mode, or the system does not have a value of "1" for "fips_enabled" in
# "/proc/sys/crypto", this is a finding. If the hardware configuration of the
# operating system does not allow for enabling FIPS mode, and has been documented
# with the Information System Security Officer (ISSO), this requirement is Not
# Applicable.


- name: TOSS-04-040040 - TOSS must implement NIST FIPS-validated cryptography for the following to provision digital signatures; to generate cryptographic hashes; and to protect unclassified information requiring confidentiality and cryptographic protection in accordance with applicable federal laws, Executive Orders, directives, policies, regulations, and standards.
  # TODO: Implement the task
  when:
    - toss_04_040040 | bool
  tags:
    - V-253059
    - SRG-OS-000033-GPOS-00014
    - SV-253059r825086_rule
    - TOSS-04-040040
    - DISA-STIG-TOSS-04-040040
    - high_severity
    - CCI-000068
    - CCI-002450
    - isso_documented
