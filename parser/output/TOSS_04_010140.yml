# https://www.stigviewer.com/stig/toss_4/2023-xx-xx/finding/V-252924

# Verify the SSH daemon is configured to use only ciphers employing
# FIPS 140-2-approved algorithms: Verify that system-wide crypto policies are in
# effect: $ sudo grep CRYPTO_POLICY /etc/sysconfig/sshd # CRYPTO_POLICY= If the
# "CRYPTO_POLICY" is uncommented, this is a finding. Verify which system-wide
# crypto policy is in use: $ sudo update-crypto-policies --show FIPS Check that
# the ciphers in the back-end configurations are FIPS 140-2-approved algorithms
# with the following command: $ sudo grep -i ciphers
# /etc/crypto-policies/back-ends/openssh.config
# /etc/crypto-policies/back-ends/opensshserver.config
# /etc/crypto-policies/back-ends/openssh.config:Ciphers
# aes256-ctr,aes192-ctr,aes128-ctr
# /etc/crypto-policies/back-ends/opensshserver.config:CRYPTO_POLICY='-oCiphers=aes256-ctr,aes192-ctr,aes128-ctr'
# /etc/crypto-policies/back-ends/opensshserver.config:CRYPTO_POLICY='-oCiphers=aes256-ctr,aes192-ctr,aes128-ctr'
# If the cipher entries in the "openssh.config" and "opensshserver.config" files
# have any ciphers other than "aes256-ctr,aes192-ctr,aes128-ctr", the order
# differs from the example above, if they are missing, or commented out, this is a
# finding.


- name: TOSS-04-010140 - The TOSS operating system must implement DoD-approved encryption to protect the confidentiality of SSH connections.
  # TODO: Implement the task
  when:
    - TOSS_04_010140 | bool
  tags:
    - V-252924
    - SRG-OS-000250-GPOS-00093
    - SV-252924r824096_rule
    - TOSS-04-010140
    - DISA-STIG-TOSS-04-010140
    - medium_severity
    - CCI-001453
    - CCI-003123

