# https://www.stigviewer.com/stig/toss_4/2023-xx-xx/finding/V-252952

# Verify the operating system uses multifactor authentication for
# network access to privileged accounts. If it does not, this is a finding. Note:
# This requirement is applicable to any externally accessible nodes of the TOSS
# system. For compute or other intra-cluster only accessible nodes, this
# requirement is Not Applicable. One possible method for meeting this requirement
# is to require smart card logon for access to interactive accounts. Check that
# the "pam_cert_auth" setting is set to "true" in the "/etc/sssd/sssd.conf" file.
# Check that the "try_cert_auth" or "require_cert_auth" options are configured in
# both "/etc/pam.d/system-auth" and "/etc/pam.d/smartcard-auth" files with the
# following command: $ sudo grep cert_auth /etc/sssd/sssd.conf /etc/pam.d/*
# /etc/sssd/sssd.conf:pam_cert_auth = True /etc/pam.d/smartcard-auth:auth
# sufficient pam_sss.so try_cert_auth /etc/pam.d/system-auth:auth [success=done
# authinfo_unavail=ignore ignore=ignore default=die] pam_sss.so try_cert_auth If
# "pam_cert_auth" is not set to "true" in "/etc/sssd/sssd.conf", this is a
# finding. If "pam_sss.so" is not set to "try_cert_auth" or "require_cert_auth" in
# both the "/etc/pam.d/smartcard-auth" and "/etc/pam.d/system-auth" files, this is
# a finding.


- name: TOSS-04-020070 - TOSS must use multifactor authentication for network and local access to privileged and non-privileged accounts.
  # TODO: Implement the task
  when:
    - TOSS_04_020070 | bool
  tags:
    - V-252952  
    - SRG-OS-000105-GPOS-00052  
    - SV-252952r824180_rule  
    - TOSS-04-020070  
    - DISA-STIG-TOSS-04-020070  
    - medium_severity  
    - CCI-000765
    - CCI-000766
    - CCI-000767
    - CCI-000768
    