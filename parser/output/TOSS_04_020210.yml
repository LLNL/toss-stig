# https://www.stigviewer.com/stig/toss_4/2023-xx-xx/finding/V-252961

# Verify the assigned home directory of all local interactive users is
# group-owned by that user's primary GID with the following command: Note: This
# may miss local interactive users that have been assigned a privileged UID.
# Evidence of interactive use may be obtained from a number of log files
# containing system logon information. The returned directory "/home/smithj" is
# used as an example. $ sudo ls -ld $(awk -F: '($3>=1000)&&($7 !~
# /nologin/){print $6}' /etc/passwd) drwxr-x--- 2 smithj admin 4096 Jun 5 12:41
# smithj Check the user's primary group with the following command: $ sudo grep
# $(grep smithj /etc/passwd | awk -F: '{print $4}') /etc/group
# admin:x:250:smithj,jonesj,jacksons If the user home directory referenced in
# "/etc/passwd" is not group-owned by that user's primary GID, this is a finding.


- name: TOSS-04-020210 - All TOSS local interactive user home directories must be group-owned by the home directory owner's primary group.
  # TODO: Implement the task
  when:
    - TOSS_04_020210 | bool
  tags:
    - V-252961
    - SRG-OS-000480-GPOS-00227
    - SV-252961r824207_rule
    - TOSS-04-020210
    - DISA-STIG-TOSS-04-020210
    - medium_severity
    - CCI-000366

