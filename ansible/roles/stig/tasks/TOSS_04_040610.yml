# https://www.stigviewer.com/stig/toss_4/2023-xx-xx/finding/V-253103

# Verify that the system is configured to boot to the command line: $
# systemctl get-default multi-user.target If the system default target is not set
# to "multi-user.target" and the Information System Security Officer (ISSO) lacks
# a documented requirement for a graphical user interface, this is a finding.
# Verify that a graphical user interface is not installed: $ rpm -qa | grep xorg |
# grep server Ask the System Administrator if use of a graphical user interface is
# an operational requirement. If the use of a graphical user interface on the
# system is not documented with the ISSO, this is a finding.


- name: TOSS-04-040610 - The graphical display manager must not be installed on TOSS unless approved.
  block:
    - name: TOSS-04-040610 part1, get default target.
      ansible.builtin.systemd:
        name: default.target
        state: query
      register: current_default_target
    - name: TOSS-04-040610 part2, check if default target is multi-user.target
      ansible.builtin.assert:
        that:
          - current_default_target.active == "multi-user.target"
        msg: "Finding! Default target is not set to multi-user.target"
  when:
    - toss_04_040610 | bool
  tags:
    - V-253103
    - SRG-OS-000480-GPOS-00227
    - SV-253103r824981_rule
    - TOSS-04-040610
    - DISA-STIG-TOSS-04-040610
    - medium_severity
    - CCI-000366
