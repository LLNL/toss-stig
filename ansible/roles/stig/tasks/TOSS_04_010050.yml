# https://www.stigviewer.com/stig/toss_4/2023-xx-xx/finding/V-252916

# Verify the operating system disables the ability to automount
# devices. Check to see if automounter service is active with the following
# command: Note: If the autofs service is not installed, this requirement is Not
# Applicable. $ sudo systemctl status autofs autofs.service - Automounts
# filesystems on demand Loaded: loaded (/usr/lib/systemd/system/autofs.service;
# disabled) Active: inactive (dead) If the "autofs" status is set to "active" and
# is not documented with the Information System Security Officer (ISSO) as an
# operational requirement, this is a finding.


- name: TOSS-04-010050 - The TOSS file system automounter must be disabled unless required.
  systemd:
    name: autofs.service
    enabled: 'no'
    state: stopped
    masked: 'yes'
  ignore_errors: 'yes'
  when:
    - TOSS_04_010050 | bool
  tags:
    - V-252916
    - SRG-OS-000114-GPOS-00059
    - SV-252916r824072_rule
    - TOSS-04-010050
    - DISA-STIG-TOSS-04-010050
    - medium_severity
    - CCI-000778
